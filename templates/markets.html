{% extends "base.html" %}

{% block title %}Markets - Risk Engine{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6 max-w-7xl">
    
    <!-- Page Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold mb-2 flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
            </svg>
            Markets Dashboard
        </h1>
        <p class="text-base-content/70">Real-time market data and analytics powered by plugins</p>
    </div>

    <!-- Plugin Widgets -->
    {% if widgets %}
    <div class="space-y-6">
        {% for widget in widgets %}
        <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow fade-in">
            <div class="card-body">
                <!-- Widget Header -->
                <div class="flex items-center justify-between mb-4">
                    <h2 class="card-title text-2xl flex items-center gap-2">
                        <span class="text-3xl">{{ widget.icon }}</span>
                        <span>{{ widget.name }}</span>
                    </h2>
                    <div class="badge badge-primary badge-lg">{{ widget.category }}</div>
                </div>
                
                {% if widget.description %}
                <p class="text-sm text-base-content/70 mb-4">{{ widget.description }}</p>
                {% endif %}
                
                <!-- Widget Content -->
                <div id="{{ widget.id }}-container" class="widget-content">
                    {{ widget.instance.render({})|safe }}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <!-- No Widgets Available -->
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body items-center text-center py-12">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-base-content/20 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
            </svg>
            <h3 class="text-2xl font-bold mb-2">No Widgets Enabled</h3>
            <p class="text-base-content/70 mb-6 max-w-md">
                There are no market widgets currently enabled. Visit the Plugins page to enable widgets.
            </p>
            <a href="/plugins" class="btn btn-primary">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" />
                </svg>
                Manage Plugins
            </a>
        </div>
    </div>
    {% endif %}
    
    <!-- Plugin Info Card -->
    <div class="card bg-base-200 shadow-lg mt-8">
        <div class="card-body">
            <h3 class="card-title text-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-info" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                About Plugin Widgets
            </h3>
            <p class="text-sm text-base-content/70">
                This page displays market widgets provided by the plugin system. Each widget is a self-contained component that can be enabled/disabled independently. 
                Widgets automatically refresh their data and provide interactive visualizations.
            </p>
            <div class="flex gap-2 mt-4">
                <div class="badge badge-outline">Auto-refresh</div>
                <div class="badge badge-outline">Interactive</div>
                <div class="badge badge-outline">Real-time data</div>
                <div class="badge badge-outline">Customizable</div>
            </div>
        </div>
    </div>

</div>

<style>
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.fade-in {
    animation: fadeIn 0.5s ease-out forwards;
}

.widget-content {
    min-height: 200px;
}

.fade-in:nth-child(1) { animation-delay: 0.1s; }
.fade-in:nth-child(2) { animation-delay: 0.2s; }
.fade-in:nth-child(3) { animation-delay: 0.3s; }
.fade-in:nth-child(4) { animation-delay: 0.4s; }
.fade-in:nth-child(5) { animation-delay: 0.5s; }
</style>

{% endblock %}
